# 13. Formulare

> Lernziele
> - Zusammenspiel zwischen Html (Frontend) und Backend (serverseitiges javascript = nodejs)
> - POST vs. GET request (HTTP Anfragen vom Client)
>   - Parameter im Get request
> - HTTP Response (HTTP Antwort) vom Server
>
> - CSS Spezifität
> - Emmet Einleitung + kleine Bsp.

**Wiederholung**

- Formulare:
    1. `<form action="meine/seite/feedback.php">`
        - mit action haben wir einen Zieladdresse für unseren Backendserver
        - wenn eine Formular abschickt wird, werden die Daten dort verarbeitet
        2. `<input type="" name="nachname" required>`
            - typen können sein:
                - email: hier validiert der Browser ob die email korrekt eingegeben wurde
                - text: allgemeines Texteingabefeld
                - password: zeichen werden durch Sternchen oder Punkte visuell ersetzt
                    - garantiert aber keinerlei Sicherheit
                - radiobutton: einen Wert auswählen
                - checkbox: mehrere Werte auswählen
                
        3. `<textarea name="msg" rows="" cols="" maxlength="">`
            - Attribute: 
                - rows: wie hoch das Eingabefeld ist
                - cols: wie breit das Eingabefeld ist
                - name: relevant für Backendserver: `data = {"msg": "Hello World", "nachname: "Bob"}`
                - maxlength: maximale Eingabelänge

        4. Dropdown Liste
```html
<select multiple name="meine_werte">
<option value="val1">Bsp 1<option>
<option value="val2">Bsp 2<option>
</select>
```
- das Backend würde bei mehrfacher Auswahl folgendes empfangen: `{"meine_werte": ["val1", "vla2"]}`

- CSS für formulare:
    - wir haben spezielle Pseudoklassen:
        - `valid` 
        - `invalid`

    ```html
    <input type="mail" required>
    <input type="password" required>
    ```
    ```css
    input[type="mail"]:invalid {border: 2px solid red}
    input[type="mail"]:valid {border: 2px solid green}


## Formulardaten an den Server senden

* Formulardaten werden im Browser eingegeben und anschließend **an den Webserver gesendet**.
* Der Server verarbeitet diese Daten weiter, z. B. per PHP-Skript oder nodejs Skript (Javascript).
* Das Beispiel zeigt keinen tiefen Einstieg in Javascript, sondern nur den **Datenfluss** vom HTML-Formular zum Server.
* Ziel: Verständnis, **wie** Daten übertragen werden – nicht, wie Backend-skript funktioniert 


### **Datenübertragung vom Browser an den Server**
* Wohin die Daten gesendet werden, bestimmt **`action`** im `<form>`-Tag.


`<form method="post" action="http://localhost:3000/submit">`


* Dort liegt typischerweise ein **Server-Skript** (z. B. `form-mail.php`), das die Eingaben verarbeitet.

Beispiel (siehe Abschnitt fieldset):


### **Wie der Browser die Daten sendet**

* Der Browser erstellt beim Absenden automatisch einen **HTTP-Request**.

* Dieser Request enthält:

  * die gewählte Methode (GET oder POST),
  * den Pfad zur Ressource (z. B. `form-mail.php`),
  * die übertragenen Daten.

Beispiel eines GET-Requests (vereinfachte Form):


`GET http://adresse.de/script.js HTTP/1.1`


### **Rolle des `method`-Attributs**

* `method="get"` (Standard)

  * Daten werden an die URL angehängt (sichtbar in der Adresszeile).
    * Gut für Suchfelder und nicht-sensible Daten.

* `method="post"`

    * Daten werden im **Request-Body** übertragen (nicht sichtbar in der Adresszeile).  
    * Standard für Kontaktformulare, Logins, Textareas etc.

### Serververarbeitung

* Das Skript im `action`-Attribut empfängt die Daten.
Beispiel
* verarbeitet Name, E-Mail, Nachricht usw.

* Das Skript kann:

  * Daten prüfen,
  * E-Mails versenden,
  * in Datenbanken speichern,
  * eine Antwortseite erzeugen.

* Bei `method="get"` werden Formulardaten **an die URL angehängt**.

* Die Adresse erhält hinter dem **?** einen **Query String**.



`https://www.internetadresse.de/form-mail.php?vname=piet&nname=pro&mail=piet%40gmail.de&nachricht=Hallo+Piet%21%0D%0A...`


* `?` trennt URL und Parameter
* `name=value` beschreibt ein Name-Wert-Paar
* `&` trennt mehrere Paare   

### **Struktur nach dem Zerlegen**

* Basis-URL:

`https://www.internetadresse.de/form-mail.php`

* Parameter als Name-Werte-Paare:

vname=piet
nname=pro
mail=piet%40gmail.de
nachricht=Hallo+Piet%21%0D%0A...


### **URL-Codierung**

* GET verwendet **URL-Encoding**.
* Beispiele:

  * Leerzeichen → `+` oder `%20`
  * `@` → `%40`
  * `!` → `%21`
  * Zeilenumbruch → `%0D%0A`

D.h.,dass das backend folgende Daten in diesem Format empfängt:

vname="piet"
nname="pro"
mail="piet@gmail.de"
nachricht="Hallo Piet!
..."

### **Kurzüberblick GET vs. POST**

| Methode  | Eigenschaften                                                                        |
| -------- | ------------------------------------------------------------------------------------ |
| **GET**  | Daten in URL sichtbar, Länge begrenzt, für Abfragen ohne sensiblen Inhalt            |
| **POST** | Daten im Request-Body, keine sichtbare URL-Anzeige, für Formulare mit Nutzereingaben |


## **Formulardaten mit Express verarbeiten**

Für das Verständnis der Formularverarbeitung ist entscheidend, **wie Daten vom Browser an den Server gesendet und dort verarbeitet werden**.
Hier wird ein**Express-Backend** verwendet.

1. eim Absenden eines Formulars sendet der Browser alle Eingaben als **POST-Anfrage** 
    - an die im `action`-Attribut definierte URL.
2. Backend liest diese Daten aus, verarbeitet sie
3. gibt anschließend eine Rückmeldung – Erfolg oder Fehler.

1. **Formulardaten empfängt**,
2. **Formulardata sollen in der Konsole ausgegeben werden**,
3. **bei Erfolg auf eine Danke-Seite weiterleitet**,
4. **bei Fehler auf eine Fehlerseite**.


**Projektstruktur**
```shell
.
├── backend
│   ├── app.js
│   ├── package.json
│   ├── package-lock.json
│   └── public
│       ├── danke.html
│       └── fehler.html
└── frontend
    ├── index.html
    └── style.css
```

# **1. Express-Backend zum Empfangen von Formulardaten**

```js
//app.js
const express = require("express");
const app = express();


// Formular auslesen (urlencoded)
app.use(express.urlencoded({ extended: true }));

// POST-Endpunkt
app.post("/submit", (req, res) => {
  console.log("Formulardaten erhalten:");
  console.log(req.body); // <-- Formular daten


// Hier wird gesteurt welche Antwort zurückgegeben wird
  if (false) {  
    res.redirect("/danke.html");
  } else {
    res.redirect("/fehler.html");
  }
});

// Statische HTML-Dateien aus /public bereitstellen
app.use(express.static("public"));

app.listen(3000, () => {
  console.log("Express läuft auf http://localhost:3000");
});
```
**Funktion:**

* `express.urlencoded()` liest die gesendeten Formularfelder ein.
* `req.body` enthält alle Name-Werte-Paare.
* Je nach Ergebnis wird der Browser auf **danke.html** oder **fehler.html** weitergeleitet.



```html
<!-- index.html -->
<form method="post" action="http://localhost:3000/submit">
  <fieldset>

    <label for="vname">Vorname:</label>
    <input type="text" name="name" id="vname" placeholder="Vorname" required>

    <label for="nname">Nachname:</label>
    <input type="text" name="nname" id="nname" placeholder="Nachname">

    <label for="mail">E-Mail:</label>
    <input type="email" name="mail" id="mail" placeholder="E-Mail" required>

    <label for="nachricht">Ihre Nachricht:</label>
    <textarea name="nachricht" id="nachricht"
      placeholder="Nachricht eingeben ..." required></textarea>

    <button type="submit" class="btn">Nachricht absenden</button>

  </fieldset>
</form>
```

# **3. Erfolgsseite (danke.html)**

```html
<!DOCTYPE html>
<html lang="de">
<body>
  <h2>Vielen Dank!</h2>
  <p>Wir haben Ihre Nachricht erhalten.</p>
  <a href="/">Zurück zur Startseite</a>
</body>
</html>
```

---

# **4. Fehlerseite (fehler.html)**

```html
<!DOCTYPE html>
<html lang="de">
<body>
  <h2>Fehler!</h2>
  <p>Die Daten konnten nicht verarbeitet werden.</p>
  <a href="/">Zurück zum Formular</a>
</body>
</html>
```

```shell
.
├── backend
│   ├── app.js
│   ├── package.json
│   ├── package-lock.json
│   └── public
│       ├── danke.html
│       └── fehler.html
└── frontend
    ├── index.html
    └── style.css
```

![Diagramm: Backend vs. Frontend](<shapes at 25-11-26 10.59.54.svg>)


https://pe.app/response_links/4e09d562-2377-439f-94e6-a2d21594d526 (Server Frontend Backend Form)


# Spezifität im CSS – Übersicht

* Konflikte werden zuerst über die Regel-Herkunft entschieden 
* Wenn die Herkunft identisch ist, entscheidet die Spezifität.
* Inline-Styles besitzen die höchste Spezifität.
* Danach folgen Selektoren mit IDs.
    * Klassen-, Attribut- und Pseudoklassen-Selektoren liegen darunter.
        * Element- und Pseudoelement-Selektoren haben die niedrigste Spezifität.
* Spezifität ergibt sich auch aus der Struktur eines Selektors.
* Mehr Klassen im Selektor → höhere Spezifität als ein Selektor mit nur einer Klasse.
* Beispiel: `.a.b` ist stärker als `.a`.

```html
<div class="a b">
```

```css
.a.b {  /*höhere Spezifität*/
    border: red 1px solid;
}

.a {
    border: red 1px solid;
}
```

* Wenn zwei Regeln denselben Stil setzen, gewinnt die mit höherer Spezifität.


 **CSS-Beispiel** 

```html
<main id="main-nav">
    <a class="feature" href="">....
```

```css
/* Stärkerer Selektor: ID + Element  */
#main-nav a {
    color: white;
    background-color: gray;
}

/* Schwächerer Selektor: nur eine Klasse */
.feature {
    background-color: orange; /*wird NICHT angewendet*/
}
```

* Inline-Styles haben sehr hohe Priorität.
* Um sie aus dem Stylesheet heraus zu überschreiben,
    * müsste `!important` verwendet werden.

### Spezifitäts-Notation

* Spezifität wird häufig als drei Zahlen notiert:
**IDs, Klassen, Tags**.

| Selector                    | IDs | Classes | Tags | Notation |
|-----------------------------|-----|---------|------|----------|
| `html body header h1`       | 0   |  0      | 4    |  0,0,4    |
| `body header.page-header h1`| 0   |   1     |  3   |  0,1,3
| `.page-header .title`       | 0   |  2      | 0    |  0,2,0
| `#page-title`               | 1   |  0      | 0    |  1,0,0  


### Vergleich

* **1,0,0** schlägt **0,2,2** und selbst **0,10,0**.
* Grund: Die erste Zahl (IDs) hat die höchste Gewichtung.


### Vierer-Notation (optional)

* Inline-Styles werden manchmal als **1,0,0,0** notiert.
* Selektoren liegen darunter, z. B. **0,1,2,0** (1 ID, 2 Klassen).
* Inline-Styles überstimmen damit alle Selektoren.


# Emmet

**Emmet** ist ein Tool, das in vielen Code-Editoren (z. B. VS Code, WebStorm, Sublime) eingebaut ist und extrem schnelle HTML- und CSS-Erstellung ermöglicht.

Man schreibt **Abkürzungen**, und Emmet erweitert sie automatisch zu vollständigem Code.

### **1. Grundstruktur erzeugen**

Abkürzung:

```
!
```

rgebnis:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

</body>
</html>
```

## **2. Elemente mit ID und Klasse**

Abkürzung:

```
div#box
```

```html
<div id="box"></div>
```

Abkürzung:

```
p.info
```

```html
<p class="info"></p>
```

### **3. Verschachtelte Elemente**

Abkürzung:

```
ul>li
```
```html
<ul>
    <li></li>
</ul>
```

Abkürzung:

```
nav>ul>li*3
```

```html
<nav>
    <ul>
        <li></li>
        <li></li>
        <li></li>
    </ul>
</nav>
```

### **4. Wiederholungen**

Abkürzung:

```
li.item*5
```

→

```html
<li class="item"></li>
<li class="item"></li>
<li class="item"></li>
<li class="item"></li>
<li class="item"></li>
```


### **5. Text einfügen**

Abkürzung:

```
p{Hallo Welt}
```

```html
<p>Hallo Welt</p>
```

bkürzung:

```
h1+p+p
```

→

```html
<h1></h1>
<p></p>
<p></p>
```


### **7. Kombinationen**

Abkürzung:

```
section#hero>h1.title{Start}+p.subtitle{Hello}+a.btn{Mehr}
```

```html
<section id="hero">
    <h1 class="title">Start </h1>
    <p class="subtitle">Hello</p>
    <a class="btn">Mehr</a>
</section>
```


### **8. Mit Attributen**

Abkürzung:

```
img[src="img.jpg" alt="Beschreibung"]
```

→

```html
<img src="img.jpg" alt="Beschreibung">
```


### **9. Tabellen schnell erzeugen**

Abkürzung:

`table>tr*3>td*2`

```html
<table>
    <tr>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
    </tr>
</table>
```

### **10. Formulare**

Abkürzung:

```
form>label+input:text+button{Senden}
```

→

```html
<form>
    <label></label>
    <input type="text">
    <button>Senden</button>
</form>
```